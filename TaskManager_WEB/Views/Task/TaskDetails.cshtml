@using System.Security.Claims
@model TaskDtoWeb
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpAcc

<h2 class="mt-5">Görev Detayları</h2>
<div class="task-details container mt-3 p-4 border rounded">
    <hr />
    <div class="form-group row mb-3">
        <label class="col-sm-2 col-form-label">Atanan Ad Soyad:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control" value="@Model.AsaignedUserName @Model.AsaignedUserLastName">
        </div>
    </div>
    <div class="form-group row mb-3">
        <label class="col-sm-2 col-form-label">Mail Adresi:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control" value="@Model.AsaignedUserEmail">
        </div>
    </div>
    <div class="form-group row mb-3">
        <label class="col-sm-2 col-form-label">Departman:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control" value="@Model.Department.DepartmentName">
        </div>
    </div>
    <div class="form-group row mb-3">
        <label class="col-sm-2 col-form-label">Atama Yapan Kişi:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control" value="@Model.CreaterUserName @Model.CreaterUserLastName">
        </div>
    </div>
    <div class="form-group row mb-3">
        <label class="col-sm-2 col-form-label">İş ve Görev Tanımı:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control" value="@Model.TaskName">
        </div>
    </div>
    <div class="form-group row mb-3">
        <label class="col-sm-2 col-form-label">Durum:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control" value="@Model.StatusDescription">
        </div>
    </div>
    <div class="form-group row">
        <div class="col-sm-12 text-center">

            @if (HttpAcc.HttpContext.User.FindFirst(ClaimTypes.NameIdentifier)?.Value == Model.CreaterUserId.ToString())
            {
                <a asp-controller="Task" asp-action="Update" asp-route-id="@Model.Id" class="btn btn-success">Düzenle</a>

                <form asp-controller="Task" asp-action="DeleteTask" method="post" onsubmit="return confirm('Bu görevi silmek istediğinize emin misiniz?');" style="display:inline;">
                    <input type="hidden" name="id" value="@Model.Id" />
                    <button type="submit" class="btn btn-danger">Sil</button>
                </form>
            }

            <a asp-action="GetAllUsers" asp-controller="user" class="btn btn-secondary">Geri</a>
        </div>
    </div>
</div>
